Я выбрал naxsi в качестве WAF, поставил его поверх nginx и включил правило фильтрации отночительно sqli. Также настроил обратный прокси для того, чтобы было возможно просматривать содержимое пакетов.

Очевидно, что если мы подключаемся напрямую к серверу WEB_app, то никакой фильтрации не происходит и мы можем эксплуатировать уязвимости

На скриншоте видно, что применены только фильтры к наличию SQL инъекции, однако можно включить и другие в файле /etc/nginx/sites-available/default